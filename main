# BMI-110
import sys
class Menu:
    def __init__(self, main_menu = 0):
        self.main_menu = main_menu

    def user_input(self):
        while True:
            user_selection = input("\nSelect a number: \n1. Patient Portal \n"
                                   "2. Doctor Portal\n"
                                   "Please select: ")
            try: 
                try:
                    self.main_menu = int(user_selection)
                    if self.main_menu == 1:
                        print("Patient Portal selected. ")
                        d = Patient()
                        d.patient_names()
                        break
                    elif self.main_menu == 2:
                        print("Doctor Portal selected. ")
                        e = Doctor()
                        e.doctor_menu()
                        break
                    else:
                        print('Wrong number selected. Try again. \n')
                except ValueError:
                    self.main_menu = float(user_selection)
            except ValueError:
                print("Error, not a number. Try again. \n")

class Person:
    def __init__(self, last_name, first_name):
        self.last_name = last_name
        self.first_name = first_name

    def print_name(self):
        print("Profile for patient %s %s is: " %
              (self.last_name, self.first_name))
        
class Doctor(Person):
    def __init__(self, first_name = '', last_name = '', dictionary_keys = {}):
        super().__init__(first_name, last_name)
        self.first_name = first_name
        self.last_name = last_name
        self.dictionary_keys = dictionary_keys
    def doctor_login(self): 
        print("Hello! Before going any further, provide"
              " your Doctor login please. ")
        while True:
            try:
                try:
                    default_doctor_ID = "c"
                    default_doctor_password = 1 
                    doctor_input = input("Username: ")
                    if doctor_input == default_doctor_ID:
                        doctor_input = int(input("What is your password? "))
                        if doctor_input == default_doctor_password:
                            print("Welcome default doctor\n")
                            break
                        else:
                            print("Wrong password")
                    else:
                        print("Wrong username. ")
                except ValueError:
                    doctor_input = float(doctor_input)
            except ValueError:
                print("Try again. ")
        
    def database_addition(self):
        print("For the key identifier, we'll use the patient ID. ")
        key_id = input("Patient ID: ")
        attributes_list = []
        self.first_name = input("First name: ")
        attributes_list.append(self.first_name)
        self.last_name = input("Last name: ")
        attributes_list.append(self.last_name)
        self.age = int(input("age: "))
        attributes_list.append(self.age)
        self.address = input("Address: ")
        attributes_list.append(self.address)
        self.admit_date = input("Admit date: ")
        attributes_list.append(self.admit_date)
        self.dictionary_keys[key_id] = attributes_list
        for key, value in self.dictionary_keys.items():
            print(key, value)
    def database(self):
        for key,value in self.dictionary_keys.items():
            print(key,value)
    def fetch(self,key):
        return self.dictionary_keys[key]
    
    def doctor_menu(self):
        #dictionary_keys = {}
        w = Doctor()
        w.doctor_login()
        x = Menu()
        while True:
            try:
                doctor_welcome = int(input("Welcome to the Doctor Portal. To create a Patient profile, press 1.\n"
                                            "For a list of patients, press 2. To go back to the main menu, press 0. Please select: "))
                try:
                    if doctor_welcome == 0:
                        x.user_input()
                    if doctor_welcome == 1:
                        print('Welcome to create a patient profile. ')
                        key_add = int(input("How many patients to add? "))
                        for i in range(key_add):
                            w.database_addition()
                        back_to_patient_menu = input('Back to patient menu? ')
                        if back_to_patient_menu == "n" or back_to_patient_menu == "N":
                            break
                        while back_to_patient_menu != 'y' and back_to_patient_menu != 'Y':
                            back_to_patient_menu = input("That's not a valid choice. (Y)es or (N)o? ")
                            if back_to_patient_menu == "n" or back_to_patient_menu == "N":
                                sys.exit()
                    elif doctor_welcome == 2:
                        if not self.dictionary_keys:
                            print("Empty")
                        else:
                            print("Here's a list: ")
                            for key, value in self.dictionary_keys.items():
                                print("Patient ID: ", key, value)
                except ValueError:
                    doctor_welcome = float(doctor_welcome)
            except ValueError:
                print("Try again. ")
               
class Patient(Doctor):
    def __init__(self, patient_id = 0, first_name = '', last_name = '', age = 0,
                 address = '', admit_date = ''):
        super().__init__(first_name = '', last_name = '', dictionary_keys = {})
        self.patient_id = patient_id
        self.first_name = first_name
        self.last_name = last_name
        self.age = age
        self.address = address
        self.admit_date = admit_date

    def patient_names(self):
        count = 0
        counts = 0
        while True:
            try:
                patient_welcome = int(input("If you're a patient and would like to see your profile, press 1.\n"
                                            "Please select: "))
                try:
                    if patient_welcome == 1:
                        w = Doctor()
                        w.database()
                        patient_id = input("What is your unique patient ID? ")
                        patient_first_name = input("What is your first name? ")
                        patient_last_name = input("What is your last name? ")
                        result = w.fetch(patient_id)
                        if patient_id and patient_first_name in result:
                            if patient_last_name in result:
                                for c in patient_first_name:
                                    if c in result[0]:
                                        count += 1
                                for c in patient_last_name:
                                    if c  in result[1]:
                                        counts += 1
                                s = '*'
                                print(f'Hello {patient_first_name[0] :{s}<{count}}' + f'{patient_last_name[0] :{s}<{counts}}')
                            else:
                                print("Not in database. ")
                        else:
                            print("Not in database. ")
                    else:
                        print('Wrong number selected. Try again. \n')
                except ValueError:
                    patient_welcome = float(patient_welcome)
            except ValueError:
                print("Error, not a number. Next time, enter numeric input. \n")

    def __str__(self):
        return self.patient_names() + self.add_mask()
      
initialize = Menu()
initialize.user_input()
